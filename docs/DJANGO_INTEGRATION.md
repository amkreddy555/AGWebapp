# Django Integration Guide

This guide explains how to serve your AquaGenius static export (`out` folder) within an existing Django application.

## 1. Directory Structure Mapping

To integrate beautifully with Django, you should map the folders as follows:

| Next.js (`out/`) | Django Project |
| :--- | :--- |
| `index.html` | `templates/index.html` |
| `products/` | `templates/products/` |
| `_next/` | `static/_next/` |
| `assets/` | `static/assets/` |
| `favicon.ico` | `static/favicon.ico` |

## 2. Django Configuration

### Step A: Update `settings.py`
Ensure your static and template directories are correctly defined:

```python
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],
        # ...
    },
]

STATIC_URL = 'static/'
STATICFILES_DIRS = [
    BASE_DIR / 'static',
]
```

### Step B: Create a View (`views.py`)
Create a simple view to serve the entry point:

```python
from django.shortcuts import render

def home(request):
    return render(request, 'index.html')

def product_detail(request, product_id):
    # Map to the static HTML generated by Next.js
    return render(request, f'products/{product_id}.html')
```

### Step C: Configure URLs (`urls.py`)

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('products/<str:product_id>/', views.product_detail, name='product_detail'),
]
```

## 3. Important: Path Handling

### The "Static" Tag Challenge
Next.js generates HTML with hardcoded paths (e.g., `/_next/static/...`). Django expects `{% static '...' %}`. 

**Two Solutions:**

#### Option 1: The "Simple" Way (Recommended for Demos)
Just tell Django to serve everything under the root `/` as static if it doesn't match a view. Or, more simply, place the `_next` and `assets` folders in your **Web Server's root** (Nginx/Apache) so the paths match perfectly.

#### Option 2: The "Django" Way
If you must use `{% static %}`, you will need to find-and-replace the paths in the generated HTML files:
- Replace `/_next/` with `/static/_next/`
- Replace `/assets/` with `/static/assets/`

## 4. Automation Script (Optional)
If you do this frequently, you can create a small Python script in your Django root to automate the move:

```python
import shutil
import os

def deploy_nextjs():
    # 1. Clear old assets
    shutil.rmtree('static/_next', ignore_errors=True)
    
    # 2. Copy new assets
    shutil.copytree('../AWebapp/out/_next', 'static/_next')
    shutil.copytree('../AWebapp/out/assets', 'static/assets')
    
    # 3. Copy HTML to templates
    shutil.copy('../AWebapp/out/index.html', 'templates/index.html')
    # ... and so on
```

> [!TIP]
> For the best performance, use **WhiteNoise** in Django to serve these static files efficiently in production.
